[{"applies_to":["c","cpp","objective-c"],"description":"These functions are historically error-prone and have been associated with a significant number of vulnerabilities. Most of these functions have safer alternatives, such as replacing \u0027strcpy\u0027 with \u0027strlcpy\u0027 or \u0027strcpy_s\u0027.","id":"DS154189","name":"Banned C function detected","patterns":[{"pattern":"\\b( (sprintf|_getts|_getws|_snprintf|_sntprintf|_snwprintf|_stprintf|_tcsat|_tcscpy|_tcslen|_tcsncpy|_vsnprintf|_vsntprintf|_vsnwprintf|_vstprintf|alloca|asctime|atof|atoi|atoll|bsearch|ctime|fopen|fprintf|freopen|fscanf|fwprintf|fwscanf|getenv|getwd|gmtime|localtime|lstrcat|lstrcpy|mbsrtowcs|mbstowcs|memmove|mktemp|printf|qsort|rewind|scanf|setbuf|sscanf|strcatbuff|strerror|strtok|swprintf|swscanf|tmpnam|vfprintf|vfscanf|vfwscanf|vprintf|vscanf|vsnprintf|vsprintf|vsscanf|vswprintf|vswscanf|vwprintf|vwscanf|wcrtomb|wcrtombs|wcscat|wcscpy|wcslen|wcsncat|wcsncpy|wcsrtombs|wcstok|wctomb|wmemcpy|wmemmove|wnsprintf|wprintf|wscanf|wsprintf|wvnsprintf|wvsprintf) *\\()\\b","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS154189.md","severity":"Moderate","tags":["API.DangerousAPI.BannedFunction"]},{"applies_to":["c","cpp","objective-c"],"description":"strcpy is frequently dangerous, as it will cause a buffer overflow if the source is larger than the destination.","fix_its":[{"type":"RegexReplace","name":"Change to strcpy_s (Recommended for VC\u002B\u002B)","pattern":{"pattern":"\\bstrcpy\\s*\\(([^,]\u002B),([^,]\u002B?)\\)","type":"Regex","scopes":["Code"]},"replacement":"strcpy_s($1, \u003Csize of $1\u003E, $2)"},{"type":"RegexReplace","name":"Change to strlcpy","pattern":{"pattern":"\\bstrcpy\\s*\\(([^,]\u002B),([^,]\u002B?)\\)","type":"Regex","scopes":["Code"]},"replacement":"strlcpy($1, $2, \u003Csize of $1\u003E)"}],"id":"DS185832","name":"Banned C function detected (strcpy)","overrides":["DS154189"],"patterns":[{"pattern":"\\bstrcpy\\s*\\(([^,]\u002B),([^,]\u002B?)\\)","type":"Regex","scopes":["Code"]}],"recommendation":"Use strcpy_s or strlcpy if possible. If no safe function is viable, strcpy/strncpy should be proceeded by conditional checks to verify that the source string will fit in the destination with a null termnator.","rule_info":"DS185832.md","severity":"Important","tags":["API.DangerousAPI.BannedFunction"]},{"applies_to":["c","cpp","objective-c"],"description":"strncpy is dangerous, as if the source contains \u0027n\u0027 or more characters, it will not null terminate the destination.","fix_its":[{"type":"RegexReplace","name":"Change to strcpy_s (Recommended for VC\u002B\u002B)","pattern":{"pattern":"\\bstrncpy\\s*\\(([^,]\u002B),([^,]\u002B),([^,]\u002B?)\\)\u002B","type":"Regex","scopes":["Code"]},"replacement":"strcpy_s($1, $3, $2)"},{"type":"RegexReplace","name":"Change to strlcpy","pattern":{"pattern":"\\bstrncpy\\s*\\(([^,]\u002B),([^,]\u002B),([^,]\u002B?)\\)\u002B","type":"Regex","scopes":["Code"]},"replacement":"strlcpy($1, $2, $3)"}],"id":"DS111237","name":"Banned C function detected (strncpy)","overrides":["DS154189"],"patterns":[{"pattern":"\\bstrncpy\\s*\\(([^,]\u002B),([^,]\u002B),([^,]\u002B?)\\)\u002B","type":"Regex","scopes":["Code"]}],"recommendation":"Use strcpy_s or strlcpy if possible. If no safe function is viable, strcpy/strncpy should be proceeded by conditional checks to verify tha that the source string will fit in the destination with a null termnator.","rule_info":"DS111237.md","severity":"Important","tags":["API.DangerousAPI.BannedFunction"]},{"applies_to":["c","cpp","objective-c"],"description":"If the combination of strings is larger than the destination buffer, strcat will cbuffer overflow the destination buffer","fix_its":[{"type":"RegexReplace","name":"Change to strcat_s (Recommended for VC\u002B\u002B)","pattern":{"pattern":"\\bstrcat\\s*\\(([^,]\u002B),([^,]\u002B?)\\)","type":"Regex","scopes":["Code"]},"replacement":"strcat_s($1, \u003Csize of $1\u003E, $2)"},{"type":"RegexReplace","name":"Change to strlcat","pattern":{"pattern":"\\bstrcat\\s*\\(([^,]\u002B),([^,]\u002B?)\\)","type":"Regex","scopes":["Code"]},"replacement":"strlcat($1, $2, \u003Csize of $1\u003E)"}],"id":"DS141863","name":"Banned C function detected (strcat)","overrides":["DS154189"],"patterns":[{"pattern":"\\bstrcat\\s*\\(([^,]\u002B),([^,]\u002B?)\\)","type":"Regex","scopes":["Code"]}],"recommendation":"Use strcat_s or strlcat if possible. strncat\u0027s size parameter excludes the null terminator, which leads to frequent mistakes","rule_info":"DS141863.md","severity":"Important","tags":["API.DangerousAPI.BannedFunction"]},{"applies_to":["c","cpp","objective-c"],"description":"strncat adds the null terminator at character \u0027n \u002B 1\u0027, rather than at the nth character. this frequently leads to the null terminator being added in the memory adjacent to the destination buffer, rather than in the destination buffer.","fix_its":[{"type":"RegexReplace","name":"Change to strcat_s (Recommended for VC\u002B\u002B)","pattern":{"pattern":"\\bstrncat\\s*\\(([^,]\u002B),([^,]\u002B),([^,]\u002B?)\\)\u002B","type":"Regex","scopes":["Code"]},"replacement":"strcat_s($1, $3, $2)"},{"type":"RegexReplace","name":"Change to strlcat","pattern":{"pattern":"\\bstrncat\\s*\\(([^,]\u002B),([^,]\u002B),([^,]\u002B?)\\)\u002B","type":"Regex","scopes":["Code"]},"replacement":"strlcat($1, $2, $3)"}],"id":"DS108330","name":"Banned C function detected (strncat)","overrides":["DS154189"],"patterns":[{"pattern":"\\bstrncat\\s*\\(([^,]\u002B),([^,]\u002B),([^,]\u002B?)\\)\u002B","type":"Regex","scopes":["Code"]}],"recommendation":"Use strcat_s or strlcat if possible. ","rule_info":"DS108330.md","severity":"Important","tags":["API.DangerousAPI.BannedFunction"]},{"applies_to":["c","cpp","objective-c"],"description":"gets will read in as many bytes as are provided, regardless of the size of buffer recieving the bytes.  This allows for conditions that cause a buffer overlow in the destination buffer.","fix_its":[{"type":"RegexReplace","name":"Change to gets_s (Recommended for VC\u002B\u002B)","pattern":{"pattern":"\\bgets\\s*\\(([^,\\)]\u002B)\\)","type":"Regex","scopes":["Code"]},"replacement":"gets_s($1, \u003Csize of $1\u003E)"},{"type":"RegexReplace","name":"Change to fgets","pattern":{"pattern":"\\bgets\\s*\\(([^,\\)]\u002B)\\)","type":"Regex","scopes":["Code"]},"replacement":"fgets($1, \u003Csize of $1\u003E, stdin)"}],"id":"DS181021","name":"Banned C function detected (gets)","overrides":["DS154189"],"patterns":[{"pattern":"\\bgets\\s*\\(([^,\\)]\u002B)\\)","type":"Regex","scopes":["Code"]}],"recommendation":"Use gets_s or fgets if possible. fgets has different behavior from gets (may include newline for example), so care should be taken if it is used.","rule_info":"DS181021.md","severity":"Important","tags":["API.DangerousAPI.BannedFunction"]},{"applies_to":["python"],"description":"Deserializing attacker-supplied data using \u0060pickle\u0060 or \u0060cPickle\u0060 can result in code execution.","id":"DS425000","name":"Do not deserialize untrusted data.","patterns":[{"pattern":"\\bpickle\\.load\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Either add integrity protection or use a data format like JSON.","rule_info":"DS425000.md","severity":"ManualReview","tags":["Deserialization"]},{"applies_to":["java"],"description":"Deserializing attacker-supplied data using \u0060readObject\u0060 can result in code execution.","id":"DS425010","name":"Do not deserialize untrusted data.","patterns":[{"pattern":"\\.readObject\\(","type":"Regex","scopes":["Code"]}],"recommendation":"Either add integrity protection or use a data format like JSON.","rule_info":"DS425000.md","severity":"ManualReview","tags":["Deserialization"]},{"applies_to":["php"],"description":"Deserializing attacker-supplied data using \u0060unserialize\u0060 can result in code execution.","id":"DS425020","name":"Do not deserialize untrusted data.","patterns":[{"pattern":"unserialize\\(","type":"Regex","scopes":["Code"]}],"recommendation":"Either add integrity protection or use a data format like JSON.","rule_info":"DS425000.md","severity":"ManualReview","tags":["Deserialization"]},{"applies_to":["ruby"],"description":"Deserializing attacker-supplied data using YAML, Syck, or Marshall can result in code execution.","id":"DS425030","name":"Do not deserialize untrusted data.","patterns":[{"pattern":"(YAML|Syck|Marshal)\\.load","type":"Regex","scopes":["Code"]},{"pattern":"(YAML|Syck|Marshal)::load","type":"Regex","scopes":["Code"]}],"recommendation":"Either add integrity protection or use a data format like JSON.","rule_info":"DS425000.md","severity":"ManualReview","tags":["Deserialization"]},{"applies_to":["csharp","fsharp"],"description":"Deserializing attacker-supplied data using Newtonsoft.JSON with TypeNameHandling can result in code execution.","fix_its":[{"type":"RegexReplace","name":"Change to TypeNameHandling.None","pattern":{"pattern":"TypeNameHandling\\.(Objects|Arrays|Auto|All)","type":"Regex","scopes":["Code"]},"replacement":"TypeNameHandling.None"}],"id":"DS425040","name":"Do not deserialize untrusted data.","patterns":[{"pattern":"TypeNameHandling\\.(Objects|Arrays|Auto|All)","type":"Regex","scopes":["Code"]}],"recommendation":"Use TypeNameHandling.None","rule_info":"DS425000.md","severity":"ManualReview","tags":["Deserialization"]},{"applies_to":["cpp","c"],"description":"The CERT Secure Coding Standard recommends that FILE objects not be copied.","id":"DS179924","name":"Do not copy a FILE object (CERT FIO38-C)","patterns":[{"pattern":"FILE [a-z0-9_][^=]*=\\s*\\*","type":"Regex","scopes":["Code"]}],"recommendation":"Copy a pointer to the FILE object instead.","rule_info":"DS179924.md","severity":"Important","tags":["CERT.FIO38-C","C.DangerousFunctionCall"]},{"applies_to":["php"],"description":"Don\u0027t pass user input to this function.","id":"DS181731","name":"Don\u0027t pass user input to this function","patterns":[{"pattern":"(include|require|include_once|require_once|passthru)\\s*\\(.*\\$_(GET|POST|REQUEST|COOKIES|FILES)","type":"Regex","scopes":["Code"]}],"recommendation":"Validate this data before passing it to the function.","rule_info":"DS181731.md","severity":"Critical","tags":["PHP.Injection"]},{"applies_to":["c","cpp","objective-c"],"description":"If the value provided to malloc is the result of unsafe integer math, it can result in an exploitable condition. ","fix_its":[{"type":"RegexReplace","name":"Change to calloc ","pattern":{"pattern":"\\bmalloc\\s*\\(([^,\\)]\u002B)\\)","type":"Regex","scopes":["Code"]},"replacement":"calloc(\u003Cnumber of elements\u003E, \u003Csize of each element\u003E)"}],"id":"DS161085","name":"Problematic C function detected (malloc)","patterns":[{"pattern":"\\bmalloc\\s*\\(([^,\\)]\u002B)\\)","type":"Regex","scopes":["Code"]}],"recommendation":"calloc handles the most common integer math in memory allocation (# of elements * their size) with error handling to prevent overflows in most implementations, and zeros out memory","rule_info":"DS161085.md","severity":"BestPractice","tags":["API.DangerousAPI.ProblematicFunction"]},{"applies_to":["c","cpp","objective-c"],"description":"There are a number of conditions in which memcpy can introduce a vulnerability (mismatched buffer sizes, null pointers, etc.). More secure alternitives perform additional validation of the source and destination buffer","fix_its":[{"type":"RegexReplace","name":"Change to memcpy_s (Recommended for VC\u002B\u002B)","pattern":{"pattern":"\\bmemcpy\\s*\\(([^,]\u002B),([^,]\u002B),([^,\\)]\u002B)\\)","type":"Regex","scopes":["Code"]},"replacement":"memcpy_s($1, \u003Csize of $1\u003E, $2, $3)"}],"id":"DS121708","name":"Problematic C function detected (memcpy)","patterns":[{"pattern":"\\bmemcpy\\s*\\(([^,]\u002B),([^,]\u002B),([^,\\)]\u002B)\\)","type":"Regex","scopes":["Code"]}],"recommendation":"Use memcpy_s if possible.","rule_info":"DS121708.md","severity":"BestPractice","tags":["API.DangerousAPI.ProblematicFunction"]},{"applies_to":["c","cpp","objective-c"],"description":"If a string is missing a null terminator, strlen will read past the end of the buffer","fix_its":[{"type":"RegexReplace","name":"Change to strlen_s (Recommended for VC\u002B\u002B)","pattern":{"pattern":"\\bstrlen\\s*\\(([^,\\)]\u002B)\\)","type":"Regex","scopes":["Code"]},"replacement":"strlen_s($1, \u003Csize of $1\u003E)"},{"type":"RegexReplace","name":"Change to strnlen","pattern":{"pattern":"\\bstrlen\\s*\\(([^,\\)]\u002B)\\)","type":"Regex","scopes":["Code"]},"replacement":"strnlen($1, \u003Csize of $1\u003E)"}],"id":"DS140021","name":"Problematic C function detected (strlen)","overrides":["DS154189"],"patterns":[{"pattern":"\\bstrlen\\s*\\(([^,\\)]\u002B)\\)","type":"Regex","scopes":["Code"]}],"recommendation":"In instances where you know the maximum size of a string\u0027s buffer, use strlen_s or strnlen to prevent over-reading","rule_info":"DS140021.md","severity":"BestPractice","tags":["API.DangerousAPI.ProblematicFunction"]},{"applies_to":["sql"],"description":"These stored procedures provide access to system resources and should only be used with trusted data.","id":"DS224000","name":"Dangerous T-SQL Command","patterns":[{"pattern":"\\b((xp_cmdshell|xp_regread|xp_instance_regread|xp_regwrite|sp_makewebtask|xp_sendmail|sp_configure|sp_executesql|dbcc writepage))\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Ideally, do not use these functions as they are quite unsafe.  If necessary, audit to ensure no untrusted data can reach this stored procedure","rule_info":"DS224000.md","severity":"Important","tags":["API.T-SQL.Dangerous"]},{"applies_to":["ruby"],"description":"Inbound HTTP","id":"DS137038","name":"Notice: Outbound HTTP Connection","patterns":[{"pattern":"\\bNet::HTTP\\b","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS137038.md","severity":"ManualReview","tags":["ThreatModel.Integration.HTTP"]},{"conditions":[{"negate_finding":true,"pattern":{"pattern":"xmlns","type":"Regex","scopes":["Code"]},"search_in":"finding-region(-3, 0)"}],"description":"An HTTP-based URL without TLS was detected.","fix_its":[{"type":"RegexReplace","name":"Change to HTTPS ","pattern":{"modifiers":["i"],"pattern":"http://","type":"Regex","scopes":["Code"]},"replacement":"https://"}],"id":"DS137138","name":"Insecure URL","patterns":[{"modifiers":["i"],"pattern":"http://","type":"Regex","scopes":["Code"]}],"recommendation":"Update to an HTTPS-based URL if possible.","rule_info":"DS137138.md","severity":"Moderate","tags":["ThreatModel.Integration.HTTP"]},{"applies_to":["objective-c"],"description":"This line of code shows the dynamic evaluation of JavaScript, sourced from a string. It\u0027s important that this string not contain unsanitized user-supplied data, as it could be a vector for a cross-site scripting (XSS) attack.","id":"DS165746","name":"Do not execute user-provided JavaScript","patterns":[{"pattern":"\\bstringByEvaluatingJavaScriptFromString\\b","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS165746.md","severity":"Important","tags":["Design.Mobile.iOS.WebView.DynamicJavaScript"]},{"applies_to":["objective-c"],"description":"Do not create NSString objects using a user-provided format string, as this could lead to a security vulnerability. https://www.securecoding.cert.org/confluence/display/c/FIO30-C.\u002BExclude\u002Buser\u002Binput\u002Bfrom\u002Bformat\u002Bstrings","fix_its":[{"type":"RegexReplace","name":"Use a predefined format string","pattern":{"pattern":"\\[NSString stringWithFormat:\\s*([^@\\\u0022\\]]\u002B\\])","type":"Regex","scopes":["Code"]},"replacement":"[NSString stringWithFormat:@\u0022%@\u0022, $1"}],"id":"DS113286","name":"Do not include user-input directly in format strings","patterns":[{"pattern":"\\[NSString stringWithFormat:\\s*([^@\\\u0022\\]]\u002B\\])","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS113286.md","severity":"Important","tags":["ControlFlow.Injection.FormatString","cert:FIO30-C"]},{"applies_to":["powershell"],"description":"The Set-ExecutionPolicy cmdlet has been used to dynamically change the permissions available to PowerShell.","id":"DS113853","name":"Do not set a custom execution policy.","patterns":[{"pattern":"\\bSet-ExecutionPolicy\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Avoid elevating privileges if possible.","rule_info":"DS113853.md","severity":"Moderate","tags":["ControlFlow.Permission.Evalation"]},{"applies_to":["powershell"],"description":"Use of restricted functions.","id":"DS104456","name":"Use of restricted functions.","patterns":[{"pattern":"\\bGetDelegateForFunctionPointer\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSystem\\.Runtime\\.InteropServices\\.Marshal\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bWriteByte\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bMicrosoft\\.Win32\\.UnsafeNativeMethods\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bPtrToStructure\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bStructureToPtr\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b((NtCreateThreadEx|CreateRemoteThread))\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bInvoke-Command\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bInvoke-Expression\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bVirtualProtect\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\biex\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b\u0026\u0022\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b\u0026\\ \\$\\b","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS104456.md","severity":"Important","tags":["Implementation.Scripting.PowerShell.DangeousFunction"]},{"description":"Optional encryption or integrity checking can be dangerous.","id":"DS114352","name":"Encryption Marked \u0027Optional\u0027","patterns":[{"pattern":"Integrity.*optional","type":"Regex","scopes":["Code"]},{"pattern":"Encryption.*optional","type":"Regex","scopes":["Code"]}],"recommendation":"As a best practice, always enable strong encryption and integrity checking.","rule_info":"DS114352.md","severity":"Important","tags":["Cryptography.Optional"]},{"applies_to":["objective-c"],"description":"Extend default certificate validation, but do not disable or override default rules.","id":"DS181865","name":"Disabled certificate validation","patterns":[{"pattern":"setValidatesSecureCertificate:\\s*NO","type":"Regex","scopes":["Code"]},{"pattern":"setAllowsAnyHTTPSCertificate:\\s*YES","type":"Regex","scopes":["Code"]},{"pattern":"allowsAnyHTTPSCertificate\\s*=\\s*YES","type":"Regex","scopes":["Code"]},{"pattern":"validatesSecureCertificate\\s*=\\s*NO","type":"Regex","scopes":["Code"]},{"pattern":"\\bcontinueWithoutCredentialForAuthenticationChallenge\\b","type":"Regex","scopes":["Code"]},{"pattern":"kCFStreamSSL(Level|AllowsExpiredCertificates|AllowsExpiredRoots|AllowsAnyRoot|ValidatesCertificateChain|PeerName)","type":"Regex","scopes":["Code"]},{"pattern":"\\bkCFStreamPropertySSLSettings\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Always use a valid certificate, even during testing.","rule_info":"DS181865.md","severity":"Critical","tags":["Cryptography.Certificate.Validation"]},{"applies_to":["ruby"],"description":"Extend default certificate validation, but do not disable or override default rules.","id":"DS176603","name":"Disabled certificate validation","patterns":[{"pattern":"\\bOpenSSL::SSL::VERIFY_NONE\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Always use a valid certificate, even during testing.","rule_info":"DS114352.md","severity":"Critical","tags":["Cryptography.Certificate.Validation"]},{"applies_to":["python"],"description":"Extend default certificate validation, but do not disable or override default rules.","id":"DS130822","name":"Disabled certificate validation","patterns":[{"pattern":"\\.check_hostname\\s*=\\s*False","type":"Regex","scopes":["Code"]},{"pattern":"disable_ssl_certificate_validation\\s*=\\s*True","type":"Regex","scopes":["Code"]}],"recommendation":"Always use a valid certificate, even during testing.","rule_info":"DS130822.md","severity":"Critical","tags":["Cryptography.Certificate.Validation"]},{"applies_to":["cpp"],"description":"Extend default certificate validation, but do not disable or override default rules.","id":"DS159369","name":"Disabled certificate validation","patterns":[{"pattern":"\\bSECURITY_FLAG_IGNORE_CERT_CN_INVALID\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_IGNORE_CERT_DATE_INVALID\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_IGNORE_REVOCATION\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_IGNORE_UNKNOWN_CA\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_IGNORE_WRONG_USAGE\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_IGNORE_CERT_WRONG_USAGE\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Always use a valid certificate, even during testing.","rule_info":"DS114352.md","severity":"Critical","tags":["Cryptography.Certificate.Validation"]},{"applies_to":[".config"],"description":"Extend default certificate validation, but do not disable or override default rules.","id":"DS101940","name":"Disabled certificate validation","patterns":[{"pattern":"certificateValidationMode\\s*=\\s*\u0022None\u0022","type":"Regex","scopes":["Code"]},{"pattern":"checkCertificateName\\s*=\\s*\u0022false\u0022","type":"Regex","scopes":["Code"]},{"pattern":"checkCertificateRevocationList\\s*=\\s*\u0022false\u0022","type":"Regex","scopes":["Code"]},{"pattern":"encryptionPolicy\\s*=\\s*\u0022(AllowNoEncryption|NoEncryption)","type":"Regex","scopes":["Code"]}],"recommendation":"Always use a valid certificate, even during testing.","rule_info":"DS114352.md","severity":"Critical","tags":["Cryptography.Certificate.Validation"]},{"applies_to":["javascript"],"description":"Extend default certificate validation, but do not disable or override default rules.","id":"DS125134","name":"Disabled certificate validation","patterns":[{"pattern":"NODE_TLS_REJECT_UNAUTHORIZED|rejectUnauthorized","type":"Regex","scopes":["Code"]}],"recommendation":"Always use a valid certificate, even during testing.","rule_info":"DS114352.md","severity":"Critical","tags":["Cryptography.Certificate.Validation"]},{"applies_to":["java"],"description":"Extend default certificate validation, but do not disable or override default rules.","id":"DS152094","name":"Disabled certificate validation","patterns":[{"pattern":"(TrustManager|getInsecure|HostnameVerifier|AbstractVerifier|AllowAllHostnameVerifier|BrowserCompatHostnameVerifier|StrictHostnameVerifier|onReceivedSslError|insecuresocketfactory|customhostnameverifier)","type":"Regex","scopes":["Code"]}],"recommendation":"Always use a valid certificate, even during testing.","rule_info":"DS114352.md","severity":"Critical","tags":["Cryptography.Certificate.Validation"]},{"applies_to":["powershell"],"description":"Extend default certificate validation, but do not disable or override default rules.","id":"DS126185","name":"Disabled certificate validation","patterns":[{"pattern":"::ServerCertificateValidationCallback\\s*=\\s*{\\s*\\$true\\s*}","type":"Regex","scopes":["Code"]}],"recommendation":"Always use a valid certificate, even during testing.","rule_info":"DS114352.md","severity":"Critical","tags":["Cryptography.Certificate.Validation"]},{"applies_to":["python"],"conditions":[{"pattern":{"pattern":"requests\\.","type":"Regex","scopes":["Code"]},"search_in":"finding-region(-3, 0)"}],"description":"Extend default certificate validation, but do not disable or override default rules.","id":"DS126186","name":"Disabled certificate validation","patterns":[{"pattern":"verify\\s*=\\s*False","type":"Regex","scopes":["Code"]}],"recommendation":"Always use a valid certificate, even during testing.","rule_info":"DS114352.md","severity":"Critical","tags":["Cryptography.Certificate.Validation"]},{"applies_to":["csharp","fsharp"],"description":"Extend default certificate validation, but do not disable or override default rules.","id":"DS126187","name":"Disabled certificate validation","patterns":[{"pattern":"\\.ServerCertificateValidationCallback\\s*=\\s*delegate\\s*{\\s*return true;\\s*};","type":"Regex","scopes":["Code"]},{"pattern":"\\.ServerCertificateValidationCallback\\s*=\\s*\\(?[^\\)]\u002B\\)\\s*=\u003E\\s*{\\s*return true;\\s*};","type":"Regex","scopes":["Code"]},{"pattern":"\\.ServerCertificateValidationCallback\\s*=\\s*\\(\u002B[^\\)]\u002B\\)\\s*=\u003E\\s*true","type":"Regex","scopes":["Code"]},{"pattern":"RemoteCertificateValidationCallback\\(delegate\\s*{\\s*return true;\\s*}\\);","type":"Regex","scopes":["Code"]},{"pattern":"\\.CertificatePolicy\\s*=\\s*delegate\\s*{\\s*return true;\\s*};","type":"Regex","scopes":["Code"]},{"pattern":"\\bX509CertificateValidationMode\\.None\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Always use a valid certificate, even during testing.","rule_info":"DS114352.md","severity":"Critical","tags":["Cryptography.Certificate.Validation"]},{"applies_to":["php"],"description":"The PHP mcrypt module is based on libmcrypt, which has been abanonded since 2007.","id":"DS175862","name":"Do not use the mcrypt module, use OpenSSL instead.","patterns":[{"pattern":"mcrypt","type":"Regex","scopes":["Code"]}],"recommendation":"OpenSSL","rule_info":"DS175862.md","severity":"Moderate","tags":["Cryptography.Library.Abandoned"]},{"applies_to":["csharp","fsharp"],"description":"The 3DES cipher was found, which is only secure if three independent keys are used.","fix_its":[{"type":"RegexReplace","name":"Change to AESCryptoServiceProvider","pattern":{"pattern":"TripleDESCryptoServiceProvider","type":"Regex","scopes":["Code"]},"replacement":"AESCryptoServiceProvider"}],"id":"DS109501","name":"Do not use the 3DES symmetric block cipher.","overrides":["DS106864"],"patterns":[{"pattern":"\\bTripleDESCryptoServiceProvider\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Use AES instead.","rule_info":"DS109501.md","severity":"Moderate","tags":["Cryptography.Symmetric.PotentiallyWeakAlgorithm"]},{"applies_to":[],"description":"The DES cipher was found, which is widely considered to be broken.","fix_its":[{"type":"RegexReplace","name":"Change to AES","pattern":{"pattern":"DES","type":"Regex","scopes":["Code"]},"replacement":"AES"}],"id":"DS106863","name":"Do not use the DES symmetric block cipher.","patterns":[{"pattern":"\\bDES\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Use AES instead.","rule_info":"DS106863.md","severity":"Critical","tags":["Cryptography.Symmetric.WeakOrBrokenAlgorithm"]},{"applies_to":["csharp","fsharp"],"description":"The DES cipher was found, which is widely considered to be broken.","fix_its":[{"type":"RegexReplace","name":"Change to AESCryptoServiceProvider","pattern":{"pattern":"DESCryptoServiceProvider","type":"Regex","scopes":["Code"]},"replacement":"AESCryptoServiceProvider"}],"id":"DS106864","name":"Do not use the DES symmetric block cipher.","patterns":[{"pattern":"\\bDESCryptoServiceProvider\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Use AES instead.","rule_info":"DS106864.md","severity":"Critical","tags":["Cryptography.Symmetric.WeakOrBrokenAlgorithm"]},{"applies_to":["javascript"],"description":"The DES cipher was found, which is widely considered to be broken.","fix_its":[{"type":"RegexReplace","name":"Change to AES-128-CBC","pattern":{"pattern":"(?:DES(?:-(?:C(?:BC|FB[18]?)|E(?:CB|DE(?:-(?:C(?:BC|FB)|OFB))?)|OFB))?)","type":"Regex","scopes":["Code"]},"replacement":"AES-128-CBC"}],"id":"DS106865","name":"Do not use the DES symmetric block cipher.","patterns":[{"pattern":"[\u0027\u0022](?:DES(?:-(?:C(?:BC|FB[18]?)|E(?:CB|DE(?:-(?:C(?:BC|FB)|OFB))?)|OFB))?)[\u0027\u0022]","type":"Regex","scopes":["Code"]}],"recommendation":"Use AES instead.","rule_info":"DS106865.md","severity":"Critical","tags":["Cryptography.Symmetric.WeakOrBrokenAlgorithm.DES"]},{"applies_to":["java"],"description":"The DES cipher was found, which is widely considered to be broken.","fix_its":[{"type":"RegexReplace","name":"Change to AESEngine","pattern":{"pattern":"DESEngine|DESedeEngine","type":"Regex","scopes":["Code"]},"replacement":"AESEngine"}],"id":"DS106866","name":"Do not use the DES symmetric block cipher.","patterns":[{"pattern":"DESEngine|DESedeEngine","type":"Regex","scopes":["Code"]}],"recommendation":"Use AES instead.","rule_info":"DS106866.md","severity":"Critical","tags":["Cryptography.Symmetric.WeakOrBrokenAlgorithm.DES"]},{"applies_to":["csharp","fsharp"],"description":"The RC2 cipher was found, which is considered to be broken.","fix_its":[{"type":"RegexReplace","name":"Change to AESCryptoServiceProvider","pattern":{"pattern":"RC2CryptoServiceProvider","type":"Regex","scopes":["Code"]},"replacement":"AESCryptoServiceProvider"}],"id":"DS156431","name":"Do not use the RC2 symmetric block cipher.","patterns":[{"pattern":"\\bRC2CryptoServiceProvider\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Use AES instead.","rule_info":"DS156431.md","severity":"Critical","tags":["Cryptography.Symmetric.WeakOrBrokenAlgorithm.RC2"]},{"description":"Extend default certificate validation, but do not disable or override default rules.","id":"DS101155","name":"Disabled certificate validation","patterns":[{"pattern":"encrypt\\s*=\\s*false","type":"Regex","scopes":["Code"]},{"pattern":"encryption\\s*=\\s*false","type":"Regex","scopes":["Code"]},{"pattern":"unencrypted.*password","type":"Regex","scopes":["Code"]},{"pattern":"TODO.*crypt","type":"Regex","scopes":["Code"]}],"recommendation":"Always use a valid certificate, even during testing.","rule_info":"DS101155.md","severity":"Critical","tags":["Cryptography.Certificate.Validation"]},{"applies_to":["cpp"],"description":"SecurityContext initialization, look here for cryptography functions.","id":"DS101159","name":"Initializing Security Context","patterns":[{"pattern":"\\bInitializeSecurityContext\\b","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS101159.md","severity":"ManualReview","tags":["Cryptography.SecurityContext.Initialization"]},{"does_not_apply_to":["json","yaml"],"description":"SSL/TLS version usage should be based on an OS or external configuration.","id":"DS440000","name":"Generic: Do not hardcode SSL/TLS versions within an application.","patterns":[{"modifiers":["i"],"pattern":"(SSL|D?TLS)[_v]*[123]([123_\\.])*","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS440000.md","severity":"Important","tags":["Cryptography.Protocol.TLS.Hardcoded"]},{"does_not_apply_to":["json","yaml"],"description":"SSL/TLS version usage should be based on an OS or external configuration.","id":"DS440010","name":"OpenSSL: Do not hardcode SSL/TLS versions within an application.","patterns":[{"pattern":"SSLv2?3_method|D?TLSv1_([123]_)?(client_|server_)?method","type":"Regex","scopes":["Code"]},{"pattern":"DTLSv1_listen|SSL_stateless","type":"Regex","scopes":["Code"]},{"pattern":"SSL_(CTX_)?set_(min|max)_proto_version","type":"Regex","scopes":["Code"]},{"pattern":"SSL_EXT_TLS_ONLY|SSL_EXT_DTLS_ONLY|SSL_EXT_TLS_IMPLEMENTATION_ONLY|SSL_EXT_SSL3_ALLOWED|SSL_EXT_TLS1_2_AND_BELOW_ONLY|SSL_EXT|TLS1_3_ONLY|SSL_EXT_TLS1_2_SERVER_HELLO|SSL_EXT_TLS1_3_SERVER_HELLO","type":"Regex","scopes":["Code"]},{"pattern":"SSL_OP_(NO_(SSLv3|TLSv1|TLSv1_1|TLSv1_2|TLSv1_3|DTLSv1|DTLSv1_2))","type":"Regex","scopes":["Code"]},{"pattern":"SSL_OP_[A-Z0-9_]\u002B","type":"Regex","scopes":["Code"]},{"pattern":"(AES|DH|DHE|ADH|CAMELLIA|EDH|EXP|DES|IDEA|RC4|NULL|GOST|EXP|ECDH|ECDHE|AECDH|PSK)[A-Z0-9\\-]\u002B-?(SHA|MD|GOST)[A-Z0-9\\-]*","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS440000.md","severity":"Important","tags":["Cryptography.Protocol.TLS.Hardcoded"]},{"applies_to":["csharp","powershell","vb","fsharp"],"description":".NET- Do not hardcode SSL/TLS versions within an application.","id":"DS440020","name":".NET - Do not hardcode SSL/TLS versions within an application.","patterns":[{"pattern":"SecurityProtocolType|SecurityProtocolTypeExtensions|SslProtocols|SslProtocolsExtensions|DontEnableSchUseStrongCrypto|DisableUsingServicePointManagerSecurityProtocols|DontEnableSystemDefaultTlsVersions","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS440000.md","severity":"Important","tags":["Cryptography.Protocol.TLS.Hardcoded"]},{"applies_to":["javascript","typescript"],"description":"Node- Do not hardcode TLS protocol versions.","fix_its":[],"id":"DS440060","name":"Node- Do not hardcode TLS protocol versions.","patterns":[],"recommendation":"","rule_info":"DS440000.md","severity":"Critical","tags":["Cryptography.Protocol.TLS.Hardcoded"]},{"applies_to":["python"],"description":"Python- Do not hardcode TLS protocol versions.","fix_its":[],"id":"DS440070","name":"Python- Do not hardcode TLS protocol versions.","patterns":[{"pattern":"PROTOCOL_(SSL|TLS)v[123_]\u002B(_CLIENT|SERVER)?","type":"Regex","scopes":["Code"]},{"pattern":"\\bssl_version\\b","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS440000.md","severity":"Important","tags":["Cryptography.Protocol.TLS.Hardcoded"]},{"applies_to":["c","cpp","csharp","fsharp"],"description":"Win32- Do not hardcode TLS protocol versions.","fix_its":[],"id":"DS440071","name":"Win32- Do not hardcode TLS protocol versions.","overrides":["DS440000"],"patterns":[{"pattern":"SP_PROT_[A-Z0-9_]\u002B_(SERVER|CLIENT)","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS440000.md","severity":"Important","tags":["Cryptography.Protocol.TLS.Hardcoded"]},{"description":"A weak or broken hash algorithm was detected.","fix_its":[{"type":"RegexReplace","name":"Change to \u0022SHA256\u0022","pattern":{"pattern":"(MD2|MD4|MD5|RIPEMD|RIPEMD(128|256|160|320)|(SHA0|SHA-0|SHA1|SHA-1))","type":"Regex","scopes":["Code"]},"replacement":"SHA256"},{"type":"RegexReplace","name":"Change to \u0022SHA512\u0022","pattern":{"pattern":"(MD2|MD4|MD5|RIPEMD|RIPEMD(128|256|160|320)|(SHA0|SHA-0|SHA1|SHA-1))","type":"Regex","scopes":["Code"]},"replacement":"SHA512"}],"id":"DS126858","name":"Weak/Broken Hash Algorithm","patterns":[{"pattern":"(MD2|MD4|MD5|RIPEMD|RIPEMD(128|256|160|320)|(SHA0|SHA-0|SHA1|SHA-1))","type":"Regex","scopes":["Code"]}],"recommendation":"Consider switching to use SHA-256 or SHA-512 instead.","rule_info":"DS126858.md","severity":"Critical","tags":["Cryptography.BannedHashAlgorithm"]},{"applies_to":["objective-c"],"description":"A weak or broken hash algorithm was detected.","fix_its":[{"type":"RegexReplace","name":"Change to SHA-256","pattern":{"pattern":"CC_(MD2|MD4|MD5|SHA1)","type":"Regex","scopes":["Code"]},"replacement":"CC_SHA256"},{"type":"RegexReplace","name":"Change to SHA-512","pattern":{"pattern":"CC_(MD2|MD4|MD5|SHA1)","type":"Regex","scopes":["Code"]},"replacement":"CC_SHA512"}],"id":"DS197800","name":"Weak/Broken Hash Algorithm","overrides":["DS126858"],"patterns":[{"pattern":"CC_(MD2|MD4|MD5|SHA1)","type":"Regex","scopes":["Code"]}],"recommendation":"Use CC_SHA256 or CC_SHA512 instead.","rule_info":"DS197800.md","severity":"Critical","tags":["Cryptography.HashAlgorithm.BrokenOrWeak"]},{"applies_to":["php"],"description":"A weak or broken hash algorithm was detected.","fix_its":[{"type":"RegexReplace","name":"Change to SHA-256","pattern":{"pattern":"hash\\s*\\(\\s*[\\\u0027\\\u0022](md2|md4|md5|sha1|sha224|ripemd128|ripemd160|ripemd256|ripemd320)[\\\u0027\\\u0022](.*)\\)","type":"Regex","scopes":["Code"]},"replacement":"hash(\u0027sha256\u0027$2);"},{"type":"RegexReplace","name":"Change to SHA-512","pattern":{"pattern":"hash\\s*\\(\\s*[\\\u0027\\\u0022](md2|md4|md5|sha1|sha224|ripemd128|ripemd160|ripemd256|ripemd320)[\\\u0027\\\u0022](.*)\\)\\s*;","type":"Regex","scopes":["Code"]},"replacement":"hash(\u0027sha512\u0027$2);"}],"id":"DS128420","name":"Weak/Broken Hash Algorithm","overrides":["DS126858"],"patterns":[{"pattern":"hash\\s*\\(\\s*[\\\u0027\\\u0022](md2|md4|md5|sha1|sha224|ripemd128|ripemd160|ripemd256|ripemd320)[\\\u0027\\\u0022](.*)\\)","type":"Regex","scopes":["Code"]}],"recommendation":"When using hash(), use sha256 or sha512 as the algorithms instead","rule_info":"DS128420.md","severity":"Critical","tags":["Cryptography.HashAlgorithm.BrokenOrWeak"]},{"applies_to":["ruby"],"description":"Avoid using broken or weak hash algorithms.","fix_its":[{"type":"RegexReplace","name":"Change to SHA-256","pattern":{"pattern":"Digest::(MD5|RMD160|SHA1)","type":"Regex","scopes":["Code"]},"replacement":"Digest::SHA256"},{"type":"RegexReplace","name":"Change to SHA-512","pattern":{"pattern":"Digest::(MD5|RMD160|SHA1)","type":"Regex","scopes":["Code"]},"replacement":"Digest::SHA512"}],"id":"DS108647","name":"Do not use broken/weak cryptographic hash algorithms","overrides":["DS126858"],"patterns":[{"pattern":"Digest::(MD5|RMD160|SHA1)","type":"Regex","scopes":["Code"]}],"recommendation":"Use Digest::SHA256 or Digest::SHA512","rule_info":"DS108647.md","severity":"Critical","tags":["Cryptography.HashAlgorithm.BrokenOrWeak"]},{"applies_to":["python"],"description":"Avoid using broken or weak hash algorithms.","fix_its":[{"type":"RegexReplace","name":"Change to hashlib.sha256","pattern":{"pattern":"(md5|sha)\\.new\\(","type":"Regex","scopes":["Code"]},"replacement":"hashlib.sha256("},{"type":"RegexReplace","name":"Change to hashlib.sha512","pattern":{"pattern":"(md5|sha)\\.new\\(","type":"Regex","scopes":["Code"]},"replacement":"hashlib.sha512("}],"id":"DS196098","name":"Do not use broken/weak cryptographic hash algorithms","overrides":["DS126858"],"patterns":[{"pattern":"(md5|sha)\\.new\\(","type":"Regex","scopes":["Code"]}],"recommendation":"Use hashlib.sha256 instead.","rule_info":"DS196098.md","severity":"Critical","tags":["Cryptography.HashAlgorithm.BrokenOrWeak"]},{"applies_to":["csharp","fsharp"],"description":"A potentially weak hashing algorithm was used.","fix_its":[{"type":"RegexReplace","name":"Change to SHA-256","pattern":{"pattern":"MD5CryptoServiceProvider","type":"Regex","scopes":["Code"]},"replacement":"SHA256CryptoServiceProvider"},{"type":"RegexReplace","name":"Change to SHA-512","pattern":{"pattern":"MD5CryptoServiceProvider","type":"Regex","scopes":["Code"]},"replacement":"SHA512CryptoServiceProvider"}],"id":"DS168931","name":"Do not use broken/weak cryptographic hash algorithms","overrides":["DS126858"],"patterns":[{"pattern":"MD5CryptoServiceProvider","type":"Regex","scopes":["Code"]}],"recommendation":"Use SHA-256 instead.","rule_info":"DS168931.md","severity":"Critical","tags":["Cryptography.HashAlgorithm.BrokenOrWeak"]},{"description":"Taking a hash of a time value is suspicious, as there is insufficient entropy to protect against brute-force attacks.","id":"DS197836","name":"Do not take the hash of low-entropy content.","patterns":[{"modifiers":["i"],"pattern":"(MD4|MD5|(SHA(1|224|256|384|512))).*Time","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS197836.md","severity":"Important","tags":["Cryptography.HashAlgorithm.InsufficientEntropy"]},{"applies_to":["php"],"description":"The mcrypt_encrypt function was used without an initialization vector.","fix_its":[{"type":"RegexReplace","name":"Add initialization vector","pattern":{"pattern":"(mcrypt_encrypt\\s*\\([^,]\u002B,[^,]\u002B,[^,]\u002B,[^,]\u002B)(\\);)","type":"Regex","scopes":["Code"]},"replacement":"$1, \u003C$iv\u003E$2"}],"id":"DS188250","name":"Missing initialization vector","overrides":["DS175862"],"patterns":[{"pattern":"mcrypt_encrypt\\s*\\([^,]\u002B,[^,]\u002B,[^,]\u002B,[^,]\u002B\\);","type":"Regex","scopes":["Code"]}],"recommendation":"Add an initialization vector or consider a different cipher mode","rule_info":"DS188250.md","severity":"Important","tags":["Cryptography.Symmetric.InitializationVector.Missing"]},{"applies_to":["php"],"description":"An initialization vector was created to a static size, rather than determining it based on the encryption algorithm used.","id":"DS128921","name":"Hardcoded initialization vector size","overrides":["DS175862"],"patterns":[{"pattern":"mcrypt_create_iv\\s*\\(\\s*\\d.*","type":"Regex","scopes":["Code"]}],"recommendation":"Use mcrypt_get_iv_size to get the correct IV size based on the cipher and mode.","rule_info":"DS128921.md","severity":"Moderate","tags":["Cryptography.Symmetric.InitializationVector.HardcodedSize"]},{"applies_to":["csharp","fsharp"],"description":"It\u0027s usually better to rely on the operating system configuration, rather than hardcoding a specific SecurityProtocolType.","fix_its":[{"type":"RegexReplace","name":"Change to SecurityProtocolType.Tls12","pattern":{"pattern":"\\bSecurityProtocolType\\.(Ssl3|Tls|Tls11)\\b","type":"Regex","scopes":["Code"]},"replacement":"SecurityProtocolType.Tls12"}],"id":"DS144436","name":"Do not use outdated SSL/TLS protocols","patterns":[{"pattern":"\\b(SecurityProtocolType\\.(Ssl3|Tls|Tls11))\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Either leave off or set to SecurityProtocolType.Tls12;","rule_info":"DS144436.md","severity":"Important","tags":["Cryptography.Protocol.TLS"]},{"applies_to":["cpp"],"description":"It\u0027s usually better to rely on the operating system configuration, rather than hardcoding a specific list of protocols.","id":"DS127101","name":"Hardcoding TLS protocol version","patterns":[{"pattern":"\\b(SecPkgCred_SupportedProtocols)\\b","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS127101.md","severity":"Moderate","tags":["Cryptography.Protocol.TLS"]},{"description":"An outdated SSL/TLS protocol version is specified.","id":"DS169125","name":"Do not use outdated SSL/TLS protocols","patterns":[{"pattern":"\\b((SSLv?2|SSLv?3|TLSv?1|TLSv?10))\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Use TLS 1.2","rule_info":"DS169125.md","severity":"Important","tags":["Cryptography.Protocol.TLS"]},{"description":"An Outdated or Banned SSL/TLS Protocol is Used","id":"DS169126","name":"An Outdated or Banned SSL/TLS Protocol is Used","patterns":[{"pattern":"(SSL|TLS)v(2|23|3|1)_(client|server)","type":"Regex","scopes":["Code"]},{"pattern":"\\bSSLv2\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSSLv3\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bTLSv1\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bTLSv10\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Use TLS 1.2","rule_info":"DS169126.md","severity":"Important","tags":["Cryptography.Protocol.Banned"]},{"applies_to":["cpp","objective-c"],"description":"An Outdated or Banned SSL/TLS Protocol is Used","id":"DS169127","name":"An Outdated or Banned SSL/TLS Protocol is Used","patterns":[{"pattern":"\\bSECURITY_FLAG_40BIT\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_56BIT\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_NORMALBITNESS\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_PCT\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_PCT4\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_SSL\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_SSL3\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_STRENGTH_MEDIUM\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_STRENGTH_WEAK\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_UNKNOWNBIT\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bWINHTTP_FLAG_SECURE_PROTOCOL_SSL2\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bWINHTTP_FLAG_SECURE_PROTOCOL_SSL3\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bWINHTTP_FLAG_SECURE_PROTOCOL_TLS1\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bWINHTTP_FLAG_SECURE_PROTOCOL_ALL\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_STRENGTH_MEDIUM\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSECURITY_FLAG_STRENGTH_WEAK\\b","type":"Regex","scopes":["Code"]},{"pattern":"SP_PROT_(PCT1|SSL2|SSL3|TLS1|TLS1_0)_(CLIENT|SERVER)","type":"Regex","scopes":["Code"]},{"pattern":"\\bNSStreamSocketSecurityLevelNone\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bNSStreamSocketSecurityLevelSSLv2\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bNSStreamSocketSecurityLevelSSLv3\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bNSStreamSocketSecurityLevelTLSv1\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bkCFStreamSocketSecurityLevelNone\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bkCFStreamSocketSecurityLevelSSLv2\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bkCFStreamSocketSecurityLevelSSLv3\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bkCFStreamSocketSecurityLevelTLSv1\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bkSSLProtocolUnknown\\ \\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bkSSLProtocol3\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bkTLSProtocol1\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bkDTLSProtocol1\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bkSSLProtocol2\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bkSSLProtocol3Only\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bkTLSProtocol1Only\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bkSSLProtocolAll\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Use TLS 1.2","rule_info":"DS169126.md","severity":"Important","tags":["Cryptography.Protocol.Banned"]},{"applies_to":["python"],"description":"An Outdated or Banned SSL/TLS Protocol is Used","id":"DS169128","name":"An Outdated or Banned SSL/TLS Protocol is Used","patterns":[{"pattern":"\\bPROTOCOL_SSLv2\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bPROTOCOL_SSLv23\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bPROTOCOL_SSLv3\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bPROTOCOL_TLSv1\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Use TLS 1.2","rule_info":"DS169126.md","severity":"Important","tags":["Cryptography.Protocol.Banned"]},{"description":"Use cryptographic random numbers generators for anything even close to a security function.","id":"DS148264","name":"Do not use weak/non-cryptographic random number generators","patterns":[{"pattern":"\\bpseudoRandomBytes\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\brand\\(","type":"Regex","scopes":["Code"]},{"pattern":"random_shuffle\\(","type":"Regex","scopes":["Code"]},{"pattern":"\\bshuffle\\(","type":"Regex","scopes":["Code"]},{"pattern":"\\bRAND_MAX\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\brand\\(\\s*\\)\\s*%","type":"Regex","scopes":["Code"]},{"pattern":"\\bmwc1616\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSystem\\.Random\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b(\\bRandom\\()\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\barc4random\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Replacements depend on language.","rule_info":"DS148264.md","severity":"Important","tags":["Cryptography.PRNG.Weak"]},{"description":"Use cryptographic random numbers generators for anything even close to a security function.","id":"DS148264","name":"Do not use weak/non-cryptographic random number generators","patterns":[{"pattern":"\\bseed_from_u64\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bfastrand\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\boorandom\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Use the Rust Rand crate.","rule_info":"DS148264.md","severity":"Important","tags":["Cryptography.PRNG.Weak"]},{"description":"Use cryptographic random numbers generators for anything even close to a security function.","id":"DS148264","name":"Do not use weak/non-cryptographic random number generators","patterns":[{"pattern":"\\bDUAL_EC_DRBG\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b((32969|18273))\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Replacements depend on language.","rule_info":"DS148264.md","severity":"Important","tags":["Cryptography.PRNG.Weak"]},{"description":"Passing a predicable value to srand() is very insecure and should be avoided.","id":"DS149435","name":"Do not seed randomness based on system time or a static value.","patterns":[{"pattern":"\\bsrand\\(\\s*time\\(","type":"Regex","scopes":["Code"]},{"pattern":"\\bsrand\\(\\s*\\d\u002B\\s*\\)","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS149435.md","severity":"Critical","tags":["Cryptography.WeakRandomness"]},{"description":"An implementation of a weak/broken hash function was found in source code.","id":"DS109733","name":"Source implementation of a weak/broken cryptography hash function","patterns":[{"pattern":"242070db|02441453|db702024|53144402|3572445317","type":"Regex","scopes":["Code"]},{"pattern":"98BADCFE|FEDCBC98|C3D2E1F0|F0E1D2C3","type":"Regex","scopes":["Code"]}],"recommendation":"Do not use MD5, and always prefer OS- or library-provided cryptography implementations.","rule_info":"DS109733.md","severity":"Critical","tags":["Cryptography.HashAlgorithm.WeakOrBrokenImplementation"]},{"description":"A potentially weak cipher mode of operation was used.","id":"DS187371","name":"A weak cipher mode of operation was used","patterns":[{"pattern":"\\b((ECB|OFB|CFB|CTS|PCBC|GMAC|XCBC|IACBC|IAPM|EAX|OCB|CWC|AEAD|LRW|XEX|XTS|CMC|EME|CBCMAC|OMAC|PMAC))\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Consider using CBC, CTR, or GCM.","rule_info":"DS187371.md","severity":"Important","tags":["Cryptography.Symmetric.CipherMode.Weak"]},{"applies_to":["php"],"description":"A potentially weak cipher mode of operation was used.","fix_its":[{"type":"RegexReplace","name":"Change cipher mode to CBC","pattern":{"pattern":"MCRYPT_MODE_(ECB|CFB|OFB|NOFB|STREAM)","type":"Regex","scopes":["Code"]},"replacement":"MCRYPT_MODE_CBC"}],"id":"DS182720","name":"A weak cipher mode of operation was used","patterns":[{"pattern":"\\b(MCRYPT_MODE_(ECB|CFB|OFB|NOFB|STREAM))\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Consider using CBC, CTR, or GCM.","rule_info":"DS182720.md","severity":"Important","tags":["Cryptography.Symmetric.CipherMode.Weak"]},{"applies_to":["csharp"],"conditions":[{"pattern":{"pattern":"using System.Web","type":"Regex","scopes":["Code"]},"search_in":"only-before"}],"description":"All Controllers Should Derive From Controller.","fix_its":[{"type":"RegexReplace","name":"Change to inherit from Controller","pattern":{"pattern":"(class [^\\s]\u002BController)(([\\s{]*$)|(\\s*:\\s*(?!.*?(Controller)).*))","type":"Regex","scopes":["Code"]},"replacement":"$1 : Controller"}],"id":"DS184626","name":"All Controllers Should Derive From Controller.","patterns":[{"pattern":"class [^\\s]\u002BController\\s*:\\s*(?!.*?(Controller)).*","type":"Regex","scopes":["Code"]},{"pattern":"class [^\\s]\u002BController[\\s{]*$","type":"Regex","scopes":["Code"]}],"recommendation":"Ensure this class derives from Controller.","rule_info":"DS184626.md","severity":"Moderate","tags":["Implementation.Web.ASPNET.ControllerWithoutExtendingController"]},{"applies_to":["CSharp Project"],"description":"Do not target .NET Framework versions less than 4.7.2.","id":"DS450000","name":"Do not target .NET Framework versions less than 4.7.2.","patterns":[{"modifiers":["i"],"pattern":"\u003CTargetFramework\u003E.*\\b(net11|net20|net35|net40|net403|net45|net451|net452|net46|net461|net462|net47|net471)\\b.*\u003C/TargetFramework\u003E","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS450000.md","severity":"ManualReview","tags":["Framework.NET.Outdated"]},{"applies_to":["php"],"description":"$_REQUEST combines POST, GET, and cookie values in one array, making it easy for an attacker to modify a POST or cookie value by instead putting it in a GET and sending the URL to the victim","fix_its":[{"type":"RegexReplace","name":"Change to $_GET","pattern":{"pattern":"\\$_REQUEST","type":"Regex","scopes":["Code"]},"replacement":"$_GET"},{"type":"RegexReplace","name":"Change to $_POST","pattern":{"pattern":"\\$_REQUEST","type":"Regex","scopes":["Code"]},"replacement":"$_POST"},{"type":"RegexReplace","name":"Change to $_COOKIE","pattern":{"pattern":"\\$_REQUEST","type":"Regex","scopes":["Code"]},"replacement":"$_COOKIE"}],"id":"DS144886","name":"$_REQUEST should be avoided","patterns":[{"pattern":"\\$_REQUEST","type":"Regex","scopes":["Code"]}],"recommendation":"Use $_POST, $_GET, $_COOKIE to scope to the expected delivery method for a value ","rule_info":"DS144886.md","severity":"Moderate","tags":["Implementation.PHP"]},{"applies_to":["php"],"conditions":[{"negate_finding":true,"pattern":{"pattern":"\\b(htmlentities|htmlspecialchars|rawurlencode|urlencode)\\s*\\(.*(\\$_(POST|GET|REQUEST|COOKIE)\\[.*\\]).*\\)","type":"Regex","scopes":["Code"]},"search_in":"finding-only"}],"description":"When using $_GET/POST/COOKIE values via echo, failure to  encode the values will lead to Cross Site Scription (XSS), where a malicious party can inject script into the webpage.","fix_its":[{"type":"RegexReplace","name":"HTML Entity encode the data","pattern":{"pattern":"(\\$_(POST|GET|REQUEST|COOKIE)\\[.*\\])","type":"Regex","scopes":["Code"]},"replacement":"htmlentities($1)"},{"type":"RegexReplace","name":"URL encode the data","pattern":{"pattern":"(\\$_(POST|GET|REQUEST|COOKIE)\\[.*\\])","type":"Regex","scopes":["Code"]},"replacement":"rawurlencode($1)"}],"id":"DS163877","name":"XSS: Do not echo unencoded GET/POST/COOKIE values","patterns":[{"pattern":"\\becho.*(\\$_(POST|GET|REQUEST|COOKIE)\\[.*\\])","type":"Regex","scopes":["Code"]}],"recommendation":"HTML Entity Encode (for content going into HTML) or URL Encode (for content going into JavaScript variables) the data","rule_info":"DS163877.md","severity":"Moderate","tags":["Implementation.PHP"]},{"description":"Accessing localhost could indicate debug code, or could hinder scaling.","id":"DS162092","name":"Do not leave debug code in production","patterns":[{"pattern":"\\blocalhost\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b127\\.0\\.0\\.1\\b","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS162092.md","severity":"ManualReview","tags":["Hygiene.Network.AccessingLocalhost"]},{"description":"A \u0022TODO\u0022 or similar was left in source code, possibly indicating incomplete functionality","id":"DS176209","name":"Suspicious comment","patterns":[{"pattern":"\\b((TODO|FIXME|REMOVEME|HACK|BLACK MAGIC))\\b","type":"Regex","scopes":["Code","Comment"]}],"recommendation":"","rule_info":"DS176209.md","severity":"ManualReview","tags":["Hygiene.Comment.Suspicious"]},{"applies_to":["python","javascript","typescript","php"],"description":"If untrusted data (data from HTTP requests, user submitted files, etc.) is included in an eval statement it can allow an attacker to inject their own code.","id":"DS189424","name":"Review eval for untrusted data","patterns":[{"pattern":"\\beval\\(([^,]\u002B)\\)","type":"Regex","scopes":["Code"]}],"recommendation":"Edit the eval so that no untrusted data is included. If untrusted data is absolutely necessary a great deal of care should be taken to ensure it is properly escaped so that it cannot be executed. This is not as simple as just escaping quotes.","rule_info":"DS189424.md","severity":"ManualReview","tags":["Python.DangerousFunctionCall","JavaScript.DangerousFunctionCall","TypeScript.DangerousFunctionCall","PHP.DangerousFunctionCall"]},{"applies_to":["javascript","typescript"],"description":"If untrusted data (data from HTTP requests, user submitted files, etc.) is included in an setTimeout statement it can allow an attacker to inject their own code.","id":"DS172411","name":"Review setTimeout for untrusted data","patterns":[{"pattern":"\\bsetTimeout\\(([^,]\u002B)\\)","type":"Regex","scopes":["Code"]}],"recommendation":"Edit the setTimeout so that no untrusted data is included. If untrusted data is absolutely necessary a great deal of care should be taken to ensure it is properly escaped so that it cannot be executed. This is not as simple as just escaping quotes.","rule_info":"DS172411.md","severity":"ManualReview","tags":["JavaScript.DangerousFunctionCall","TypeScript.DangerousFunctionCall"]},{"applies_to":["csharp","vb"],"description":"The unsafe keyword denotes an unsafe context, which is required for any operation involving pointers. Unsafe code in is not necessarily dangerous; it is just code whose safety cannot be verified by the CLR.","id":"DS172412","name":"Review unsafe code","patterns":[{"pattern":"\\b(unsafe)\\b","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS172412.md","severity":"ManualReview","tags":["Dotnet.Unsafecode"]},{"applies_to":["csharp","fsharp"],"conditions":[{"pattern":{"pattern":"ZipArchiveEntry","type":"Regex","scopes":["Code"]},"search_in":"finding-region(-15,0)"}],"description":"Zip archive can contain file names with directory stepping sequence","id":"DS113854","name":"Do not extract untrusted zip archives","patterns":[{"pattern":"ExtractToFile","type":"Regex","scopes":["Code"]}],"recommendation":"Make sure that ZipArchiveEntry.FullName doesn\u0027t directory stepping characters ..\\","rule_info":"DS113854.md","severity":"ManualReview","tags":["DotNet.DangerousFunctionCall"]},{"applies_to":["objective-c"],"description":"Access to the device UDID (via [[UIDevice currentDevice] uniqueIdentifier]) is deprecated as of iOS 5 and should not be used or relied upon.","id":"DS165348","name":"Do not attempt to access device UDID","patterns":[{"pattern":"\\buniqueIdentifier\\b","type":"Regex","scopes":["Code"]}],"recommendation":"[[UIDevice currentDevice] identifierForVendor]","rule_info":"DS165348.md","severity":"Important","tags":["Implementation.Mobile.iOS.DataProtection.Privacy.UDID"]},{"description":"A token or key was found in source code. If this represents a secret, it should be moved somewhere else.","id":"DS173237","name":"Do not store tokens or keys in source code.","patterns":[{"pattern":"[\u0022\u0027][a-f0-9]{30,}[\u0022\u0027]","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS173237.md","severity":"Important","tags":["Implementation.Privacy.Token"]},{"description":"A token or key was found in source code. If this represents a secret, it should be moved somewhere else.","id":"DS117838","name":"Do not store tokens or keys in source code.","overrides":["DS173237"],"patterns":[{"pattern":"(secret|license|key|pass).*[a-f0-9]{30,}","type":"Regex","scopes":["Code"]}],"recommendation":"","rule_info":"DS117838.md","severity":"Critical","tags":["Implementation.Privacy.Token"]},{"applies_to":["csharp","fsharp"],"description":"The ProtectedData class should be used with additional entropy to reduce the risk of other application calling DPAPI to access the data.","fix_its":[{"type":"RegexReplace","name":"Add entropy placeholder","pattern":{"pattern":"(ProtectedData\\.Protect[^,]\u002B,\\s*)null(.*)","type":"Regex","scopes":["Code"]},"replacement":"$1\u003Centropy\u003E$2"}],"id":"DS112266","name":"ProtectedData used without additional entropy","patterns":[{"pattern":"ProtectedData\\.Protect.*,\\s*null.*","type":"Regex","scopes":["Code"]}],"recommendation":"Add additional entropy (per-application secret).","rule_info":"DS112266.md","severity":"Moderate","tags":["Storage.Windows.DPAPI"]},{"applies_to":["objective-c"],"description":"Do not store sensitive data in NSUserDefaults.","id":"DS191340","name":"Do not store sensitive data in NSUserDefaults.","patterns":[{"pattern":"NSUserDefaults \\*(.*) = \\[NSUserDefaults standardUserDefaults\\];(\\n.*){1,5}$1 .*setString:(password|key)","type":"Regex","scopes":["Code"]}],"recommendation":"Consider another mechanism instead.","rule_info":"DS191340.md","severity":"Moderate","tags":["Storage.Apple.iOS.UserDefaults.SensitiveData"]},{"applies_to":[".config"],"description":".NET - Hard-coded SSL/TLS Protocol","id":"DS112838","name":".NET - Hard-coded SSL/TLS Protocol","patterns":[{"pattern":"\\bSwitch\\.System\\.Net\\.DontEnableSchUseStrongCrypto\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSwitch\\.System\\.ServiceModel\\.DisableUsingServicePointManagerSecurityProtocol\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSwitch\\.System\\.Net\\.DontEnableSystemDefaultTlsVersions\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSwitch\\.System\\.ServiceModel\\.DontEnableSystemDefaultTlsVersions\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS112838.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":["csharp","powershell","vb","fsharp"],"description":".NET - Hard-coded SSL/TLS Protocol","id":"DS112837","name":".NET - Hard-coded SSL/TLS Protocol","patterns":[{"pattern":"\\bTestSwitch\\.LocalAppContext\\.DisableCaching\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSwitch\\.System\\.Net\\.DontEnableSchUseStrongCrypto\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":["cobol"],"description":"COBOL - Hard-coded SSL/TLS Protocol","id":"DS112851","name":"COBOL - Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"GSK_PROTOCOL_(SSL|TLS)V[123_]\u002B","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":["csharp","powershell","vb","fsharp"],"description":".NET - Hard-coded SSL/TLS Protocol","id":"DS112839","name":".NET - Hard-coded SSL/TLS Protocol","patterns":[{"pattern":"\\bSslStream\\.AuthenticateAsClient\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSslStream\\.AuthenticateAsClientAsync\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bBeginAuthenticateAsClient\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSslStream\\.AuthenticateAsServer\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSslStream\\.AuthenticateAsServerAsync\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bBeginAuthenticateAsServer\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"does_not_apply_to":["json","yaml"],"description":"Generic: Hard-coded SSL/TLS Protocol","id":"DS440001","name":"Generic: Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"modifiers":["i"],"pattern":"\\b(SSL|D?TLS) ?v?[0123][0123_\\.]\u002B","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"does_not_apply_to":["json","yaml"],"description":"OpenSSL: Hard-coded SSL/TLS Protocol","id":"DS440011","name":"OpenSSL: Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"SSLv2?3_method|D?TLSv1_([123]_)?(client_|server_)?method","type":"Regex","scopes":["Code"]},{"pattern":"DTLSv1_listen|SSL_stateless","type":"Regex","scopes":["Code"]},{"pattern":"SSL_(CTX_)?set_(min|max)_proto_version","type":"Regex","scopes":["Code"]},{"pattern":"SSL_EXT_TLS_ONLY|SSL_EXT_DTLS_ONLY|SSL_EXT_TLS_IMPLEMENTATION_ONLY|SSL_EXT_SSL3_ALLOWED|SSL_EXT_TLS1_2_AND_BELOW_ONLY|SSL_EXT|TLS1_3_ONLY|SSL_EXT_TLS1_2_SERVER_HELLO|SSL_EXT_TLS1_3_SERVER_HELLO","type":"Regex","scopes":["Code"]},{"pattern":"SSL_OP_(NO_(SSLv2|SSLv3|TLSv1|TLSv1_1|TLSv1_2|TLSv1_3|DTLSv1|DTLSv1_2))","type":"Regex","scopes":["Code"]},{"pattern":"((ADH-)?(AES[0-9]*|DES|RC4|SEED)-(CBC3|GCM|SHA[0-9]*|MD5))(-SHA[0-9]*)?|(AECDH-(AES[0-9]*|DES|NULL|RC4)-(SHA|CBC3))(-SHA)?|((ECDHE-(ECDSA|RSA)-)|(DHE?-(DSS|RSA)-))?(NULL|RC4|CAMELLIA[0-9]*|DES|SEED|AES[0-9]*)-(CBC3|CCM8?|GCM|SHA[0-9]*)(-SHA[0-9]*)?|DES-CBC3-SHA|(GOST(2001|94)-(GOST89|NULL))-GOST(89|94)|IDEA-CBC-SHA|NULL-(MD5|SHA(0-9)*)|TLS_(AES|CHACHA20)_([0-9]*|POLY1305)(_(CCM(_8)?|GCM))?_SHA[0-9]*","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"does_not_apply_to":["json","yaml"],"description":"BoringSSL: Hard-coded SSL/TLS Protocol","id":"DS440012","name":"BoringSSL: Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"\\b(SSL|D?TLS) ?v?[0123_\\.]*_VERSION(_MAJOR)?","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"does_not_apply_to":["json","yaml"],"description":"GnuTLS: Hard-coded SSL/TLS Protocol","id":"DS440013","name":"GnuTLS: Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"GNUTLS_(SSL|D?TLS)[01239_\\.]\u002B","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"does_not_apply_to":["json","yaml"],"description":"LibreSSL: Hard-coded SSL/TLS Protocol","id":"DS440014","name":"LibreSSL: Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"(SSL|D?TLS)[01239_\\.]\u002B_VERSION(_MAJOR|_MINOR)?","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"does_not_apply_to":["json","yaml"],"description":"mbedTLS: Hard-coded SSL/TLS Protocol","id":"DS440015","name":"mbedTLS: Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"MBEDTLS_SSL_PROTO_(SSL|D?TLS)[123_]\u002B","type":"Regex","scopes":["Code"]},{"pattern":"MBEDTLS_SSL_(MAJOR|MINOR)_VERSION_[0123]","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"does_not_apply_to":["json","yaml"],"description":"Generic: Hard-coded SSL/TLS Protocol","id":"DS440016","name":"Generic: Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"\\b--secure-protocol=\\b","type":"Regex","scopes":["Code"]},{"pattern":"--(sslv2|sslv3|tlsv1|tlsv11|tlsv1\\.1|tlsv1\\.2)","type":"Regex","scopes":["Code"]},{"pattern":"CURL_SSLVERSION_(MAX_)?(SSL|TLS)v[0123_]\u002B","type":"Regex","scopes":["Code"]},{"pattern":"ssl_protocols\\s\u002B[^;]\u002B;","type":"Regex","scopes":["Code"]},{"pattern":"\\bssl_version\\b","type":"Regex","scopes":["Code"]},{"pattern":"DISABLE_SSL_([^\\b]\u002B)","type":"Regex","scopes":["Code"]},{"pattern":"SSLProtocol\\s.\u002B","type":"Regex","scopes":["Code"]},{"pattern":"sslEnabledProtocols\\s*=","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"does_not_apply_to":["json","yaml"],"description":"Generic: Hard-coded Elliptic Curve","id":"DS440100","name":"Generic: Hard-coded Elliptic Curve","patterns":[{"pattern":"arbitrary_explicit_char2_curves|arbitrary_explicit_prime_curves|brainpoolP160r1|brainpoolP160t1|brainpoolP192r1|brainpoolP192t1|brainpoolP224r1|brainpoolP224t1|brainpoolP256r1|brainpoolp256r1|brainpoolP256t1|brainpoolP320r1|brainpoolP320t1|brainpoolP384r1|brainpoolp384r1|brainpoolP384t1|brainpoolP512r1|brainpoolp512r1|brainpoolP512t1|curve25519|ec192wapi|nistP192|nistP224|nistP256|nistP384|nistP521|numsP256t1|numsP384t1|numsP512t1|secP160k1|secp160k1|secP160r1|secp160r1|secP160r2|secp160r2|secP192k1|secp192k1|secP192r1|secp192r1|secP224k1|secp224k1|secP224r1|secp224r1|secP256k1|secp256k1|secP256r1|secp256r1|secP384r1|secp384r1|secP521r1|secp521r1|sect163k1|sect163r1|sect163r2|sect193r1|sect193r2|sect233k1|sect233r1|sect239k1|sect283k1|sect283r1|sect409k1|sect409r1|sect571k1|sect571r1|wtls12|wtls7|wtls9|X25519|X448|x962P192v1|x962P192v2|x962P192v3|x962P239v1|x962P239v2|x962P239v3|x962P256v1","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440100.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Elliptic-Curve.Hard-Coded"]},{"applies_to":["go"],"description":"Go - Hard-coded SSL/TLS Protocol","id":"DS112852","name":"Go - Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"tls13|VersionSSL30|VersionTLS1[0123]","type":"Regex","scopes":["Code"]},{"pattern":"tls\\.Curve(P256|P384|P521)","type":"Regex","scopes":["Code"]},{"pattern":"\\bX25519\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":["java"],"description":"Java - Hard-coded SSL/TLS Protocol","id":"DS112853","name":"Java - Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"setSslSecurityProtocol|SSLSecurityProtocol|Alg\\.Alias\\.SSLContext\\.TLS|jdk\\.tls\\.client\\.protocols|https\\.protocols","type":"Regex","scopes":["Code"]},{"pattern":"SSLContext\\.getInstance\\(\\\u0022([^\\\u0022]\u002B)\\\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\\b\\.ssl\\.context\\.protocol=\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":["java"],"description":"OkHttp - Hard-coded SSL/TLS Protocol","id":"DS112854","name":"OkHttp - Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"TlsVersion\\.(SSL_3_0|TLS_1_[0123])","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":["javascript","typescript"],"description":"Node - Hard-coded SSL/TLS Protocol","id":"DS112844","name":"Node - Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"\\bsecureProtocol\\b","type":"Regex","scopes":["Code"]},{"pattern":"tls-min-v[\\d\\.]\u002B","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":[],"description":"MacOS - Hard-coded SSL/TLS Protocol","fix_its":[],"id":"DS440080","name":"MacOS - Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"\\bkSSLProtocol([\\d]\u002B|MaxSupported)(Only)?","type":"Regex","scopes":["Code"]},{"pattern":"SSLSetProtocolVersion(Min|Max|Enabled)","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":["python"],"description":"Python - Hard-coded SSL/TLS Protocol","fix_its":[],"id":"DS440072","name":"Python - Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"PROTOCOL_(SSL|TLS)v?[0123_\\.]*(_CLIENT|SERVER)?","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":["rust"],"description":"Rust - Hard-coded SSL/TLS Protocol","fix_its":[],"id":"DS440073","name":"Rust - Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"ProtocolVersion::(SSLv2|SSLv3|TLSv1_[0123])","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":["csharp","powershell","vb","fsharp"],"description":".NET - Hard-coded SSL/TLS Protocol","id":"DS112835","name":".NET - Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"\\bSecurityProtocolType\\.Ssl3\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b\\(SecurityProtocolType\\)48\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSecurityProtocolType\\.SystemDefault\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b\\(SecurityProtocolType\\)0\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b\\(SecurityProtocolType\\)192\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b\\(SecurityProtocolType\\)768\\b","type":"Regex","scopes":["Code"]},{"pattern":"SecurityProtocolType\\.Tls[123]?","type":"Regex","scopes":["Code"]},{"pattern":"\\b\\(SecurityProtocolType\\)3072\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSecurityProtocolType\\.Tls13\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b\\(SecurityProtocolType\\)12288\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSecurityProtocolTypeExtensions\\.Tls11\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSecurityProtocolTypeExtensions\\.Tls12\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSecurityProtocolTypeExtensions\\.SystemDefault\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS112835.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":["csharp","powershell","vb","fsharp"],"description":".NET - Hard-coded SSL/TLS Protocol","id":"DS112836","name":".NET - Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"\\bSslProtocolsExtensions\\.Tls11\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSslProtocolsExtensions\\.Tls12\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSslProtocols\\.Default\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b\\(SslProtocols\\)240\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSslProtocols\\.None\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b\\(SslProtocols\\)0\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSslProtocols\\.Ssl2\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b\\(SslProtocols\\)12\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSslProtocols\\.Ssl3\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b\\(SslProtocols\\)48\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSslProtocols\\.Tls\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b\\(SslProtocols\\)192\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSslProtocols\\.Tls11\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b\\(SslProtocols\\)768\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSslProtocols\\.Tls12\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b\\(SslProtocols\\)3072\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\bSslProtocols\\.Tls13\\b","type":"Regex","scopes":["Code"]},{"pattern":"\\b\\(SslProtocols\\)12288\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":["c","cpp","csharp","fsharp"],"description":"Win32 - Hard-coded SSL/TLS Protocol","fix_its":[],"id":"DS440075","name":"Win32 - Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"SP_PROT_[A-Z0-9_]\u002B_(SERVER|CLIENT)","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":["c","cpp"],"description":"Win32 - Hard-coded SSL/TLS Protocol","fix_its":[],"id":"DS440074","name":"Win32 - Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"ssl::context context|ssl::context set_options|ssl::context set_options|ssl::context native_handle","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":["c","cpp"],"description":"Win32 - Hard-coded SSL/TLS Protocol","fix_its":[],"id":"DS440076","name":"Win32 - Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"NULL-MD5|NULL-SHA|EXP-RC4-MD5|RC4-MD5|RC4-SHA|EXP-RC2-CBC-MD5|IDEA-CBC-SHA|EXP-DES-CBC-SHA|DES-CBC-SHA|DES-CBC3-SHA|DH-DSS-DES-CBC-SHA|DH-DSS-DES-CBC3-SHA|DH-RSA-DES-CBC-SHA|DH-RSA-DES-CBC3-SHA|EXP-EDH-DSS-DES-CBC-SHA|EDH-DSS-CBC-SHA|EDH-DSS-DES-CBC3-SHA|EXP-EDH-RSA-DES-CBC-SHA|EDH-RSA-DES-CBC-SHA|EDH-RSA-DES-CBC3-SHA|EXP-ADH-RC4-MD5|ADH-RC4-MD5|EXP-ADH-DES-CBC-SHA|ADH-DES-CBC-SHA|ADH-DES-CBC3-SHA","type":"Regex","scopes":["Code"]},{"pattern":"AES128-SHA|AES256-SHA|DH-DSS-AES128-SHA|DH-DSS-AES256-SHA|DH-RSA-AES128-SHA|DH-RSA-AES256-SHA|DHE-DSS-AES128-SHA|DHE-DSS-AES256-SHA|DHE-RSA-AES128-SHA|DHE-RSA-AES256-SHA|ADH-AES128-SHA|ADH-AES256-SHA","type":"Regex","scopes":["Code"]},{"pattern":"CAMELLIA128-SHA|CAMELLIA256-SHA|DH-DSS-CAMELLIA128-SHA|DH-DSS-CAMELLIA256-SHA|DH-RSA-CAMELLIA128-SHA|DH-RSA-CAMELLIA256-SHA|DHE-DSS-CAMELLIA128-SHA|DHE-DSS-CAMELLIA256-SHA|DHE-RSA-CAMELLIA128-SHA|DHE-RSA-CAMELLIA256-SHA|ADH-CAMELLIA128-SHA|ADH-CAMELLIA256-SHA","type":"Regex","scopes":["Code"]},{"pattern":"CAMELLIA128-SHA|CAMELLIA256-SHA|DH-DSS-CAMELLIA128-SHA|DH-DSS-CAMELLIA256-SHA|DH-RSA-CAMELLIA128-SHA|DH-RSA-CAMELLIA256-SHA|DHE-DSS-CAMELLIA128-SHA|DHE-DSS-CAMELLIA256-SHA|DHE-RSA-CAMELLIA128-SHA|DHE-RSA-CAMELLIA256-SHA|ADH-CAMELLIA128-SHA|ADH-CAMELLIA256-SHA","type":"Regex","scopes":["Code"]},{"pattern":"SEED-SHA|DH-DSS-SEED-SHA|DH-RSA-SEED-SHA|DHE-DSS-SEED-SHA|DHE-RSA-SEED-SHA|ADH-SEED-SHA","type":"Regex","scopes":["Code"]},{"pattern":"GOST94-GOST89-GOST89|GOST2001-GOST89-GOST89|GOST94-NULL-GOST94|GOST2001-NULL-GOST94","type":"Regex","scopes":["Code"]},{"pattern":"EXP1024-DES-CBC-SHA|EXP1024-RC4-SHA|EXP1024-DHE-DSS-DES-CBC-SHA|EXP1024-DHE-DSS-RC4-SHA|DHE-DSS-RC4-SHA","type":"Regex","scopes":["Code"]},{"pattern":"EXP1024-DES-CBC-SHA|EXP1024-RC4-SHA|EXP1024-DHE-DSS-DES-CBC-SHA|EXP1024-DHE-DSS-RC4-SHA|DHE-DSS-RC4-SHA","type":"Regex","scopes":["Code"]},{"pattern":"NULL-SHA256NULL-SHA256|AES128-SHA256|AES256-SHA256|AES128-GCM-SHA256|AES256-GCM-SHA384|DH-RSA-AES128-SHA256|DH-RSA-AES256-SHA256|DH-RSA-AES128-GCM-SHA256|DH-RSA-AES256-GCM-SHA384|DH-DSS-AES128-SHA256|DH-DSS-AES256-SHA256|DH-DSS-AES128-GCM-SHA256|DH-DSS-AES256-GCM-SHA384|DHE-RSA-AES128-SHA256|DHE-RSA-AES256-SHA256|DHE-RSA-AES128-GCM-SHA256|DHE-RSA-AES256-GCM-SHA384|DHE-DSS-AES128-SHA256|DHE-DSS-AES256-SHA256|DHE-DSS-AES128-GCM-SHA256|DHE-DSS-AES256-GCM-SHA384|ECDH-RSA-AES128-SHA256|ECDH-RSA-AES256-SHA384|ECDH-RSA-AES128-GCM-SHA256|ECDH-RSA-AES256-GCM-SHA384|ECDH-ECDSA-AES128-SHA256|ECDH-ECDSA-AES256-SHA384|ECDH-ECDSA-AES128-GCM-SHA256|ECDH-ECDSA-AES256-GCM-SHA384|ECDHE-RSA-AES128-SHA256|ECDHE-RSA-AES256-SHA384|ECDHE-RSA-AES128-GCM-SHA256|ECDHE-RSA-AES256-GCM-SHA384|ECDHE-ECDSA-AES128-SHA256|ECDHE-ECDSA-AES256-SHA384|ECDHE-ECDSA-AES128-GCM-SHA256|ECDHE-ECDSA-AES256-GCM-SHA384|ADH-AES128-SHA256|ADH-AES256-SHA256|ADH-AES128-GCM-SHA256|ADH-AES256-GCM-SHA384","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":["c","cpp"],"description":"Win32 - Hard-coded SSL/TLS Protocol","fix_its":[],"id":"DS440077","name":"Win32 - Hard-coded SSL/TLS Protocol","overrides":["DS440000"],"patterns":[{"pattern":"CONF_modules_load_file|SSL_CTX_config|SSL_config|SSL_CONF_cmd|SSL_CONF_cmd_value_type","type":"Regex","scopes":["Code"]},{"pattern":"SSL_set_security_callback|SSL_set_security_level|SSL_CTX_set_security_level","type":"Regex","scopes":["Code"]},{"pattern":"SSL_(CTX_)?set_(min|max)_proto_version","type":"Regex","scopes":["Code"]},{"pattern":"DTLS_client_method|DTLS_server_method|TLS_client_method|TLS_server_method|TLS_method","type":"Regex","scopes":["Code"]},{"pattern":"SSLv3_method|SSLv3_server_method|SSLv3_client_method|SSLv23_method|SSLv23_server_method|SSLv23_client_method|TLSv1_method|TLSv1_server_method|TLSv1_client_method|TLSv1_1_method|TLSv1_1_server_method|TLSv1_1_client_method|TLSv1_2_method|TLSv1_2_server_method|TLSv1_2_client_method|DTLSv1_method|DTLSv1_server_method|DTLSv1_client_method|DTLSv1_2_method|DTLSv1_2_server_method|DTLSv1_2_client_method","type":"Regex","scopes":["Code"]},{"pattern":"SSL_set_ssl_method|SSL_CTX_set_ssl_version|SSL_CTX_new|SSL_CTX_add_client_custom_ext|SSL_CTX_add_server_custom_ext","type":"Regex","scopes":["Code"]},{"pattern":"DTLSv1_listen|SSL_stateless|SSL_CTX_add_custom_ext","type":"Regex","scopes":["Code"]}],"recommendation":"Review to ensure that a TLS protocol agility is maintained.","rule_info":"DS440000.md","severity":"ManualReview","tags":["Cryptography.Protocol.TLS.Hard-Coded"]},{"applies_to":["packages.config"],"description":"Vulnerabilities in .NET Core, ASP.NET Core Could Allow Elevation of Privilege","id":"DS300001","name":"Vulnerable NuGet Library","patterns":[{"pattern":"\u003Cpackage id=\u0022System.Text.Encodings.Web\u0022 version=\u0022(4\\.0\\.0|4\\.3\\.0)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022System.Net.Http\u0022 version=\u0022(4\\.1\\.1|4\\.3\\.1)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022System.Net.Http.WinHttpHandler\u0022 version=\u0022(4\\.0\\.1|4\\.3\\.0)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022System.Net.Security\u0022 version=\u0022(4\\.0\\.0|4\\.3\\.0)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022System.Net.WebSockets.Client\u0022 version=\u0022(4\\.0\\.0|4\\.3\\.0)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022Microsoft.AspNetCore.Mvc\u0022 version=\u0022(1\\.0\\.0|1\\.0\\.1|1\\.0\\.2|1\\.0\\.3|1\\.1\\.0|1\\.1\\.1|1\\.1\\.2)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022Microsoft.AspNetCore.Mvc.Core\u0022 version=\u0022(1\\.0\\.0|1\\.0\\.1|1\\.0\\.2|1\\.0\\.3|1\\.1\\.0|1\\.1\\.1|1\\.1\\.2)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022Microsoft.AspNetCore.Mvc.Abstractions\u0022 version=\u0022(1\\.0\\.0|1\\.0\\.1|1\\.0\\.2|1\\.0\\.3|1\\.1\\.0|1\\.1\\.1|1\\.1\\.2)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022Microsoft.AspNetCore.Mvc.ApiExplorer\u0022 version=\u0022(1\\.0\\.0|1\\.0\\.1|1\\.0\\.2|1\\.0\\.3|1\\.1\\.0|1\\.1\\.1|1\\.1\\.2)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022Microsoft.AspNetCore.Mvc.Cors\u0022 version=\u0022(1\\.0\\.0|1\\.0\\.1|1\\.0\\.2|1\\.0\\.3|1\\.1\\.0|1\\.1\\.1|1\\.1\\.2)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022Microsoft.AspNetCore.Mvc.DataAnnotations\u0022 version=\u0022(1\\.0\\.0|1\\.0\\.1|1\\.0\\.2|1\\.0\\.3|1\\.1\\.0|1\\.1\\.1|1\\.1\\.2)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022Microsoft.AspNetCore.Mvc.Formatters.Json\u0022 version=\u0022(1\\.0\\.0|1\\.0\\.1|1\\.0\\.2|1\\.0\\.3|1\\.1\\.0|1\\.1\\.1|1\\.1\\.2)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022Microsoft.AspNetCore.Mvc.Formatters.Xml\u0022 version=\u0022(1\\.0\\.0|1\\.0\\.1|1\\.0\\.2|1\\.0\\.3|1\\.1\\.0|1\\.1\\.1|1\\.1\\.2)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022Microsoft.AspNetCore.Mvc.Localization\u0022 version=\u0022(1\\.0\\.0|1\\.0\\.1|1\\.0\\.2|1\\.0\\.3|1\\.1\\.0|1\\.1\\.1|1\\.1\\.2)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022Microsoft.AspNetCore.Mvc.Razor.Host\u0022 version=\u0022(1\\.0\\.0|1\\.0\\.1|1\\.0\\.2|1\\.0\\.3|1\\.1\\.0|1\\.1\\.1|1\\.1\\.2)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022Microsoft.AspNetCore.Mvc.Razor\u0022 version=\u0022(1\\.0\\.0|1\\.0\\.1|1\\.0\\.2|1\\.0\\.3|1\\.1\\.0|1\\.1\\.1|1\\.1\\.2)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022Microsoft.AspNetCore.Mvc.TagHelpers\u0022 version=\u0022(1\\.0\\.0|1\\.0\\.1|1\\.0\\.2|1\\.0\\.3|1\\.1\\.0|1\\.1\\.1|1\\.1\\.2)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022Microsoft.AspNetCore.Mvc.ViewFeatures\u0022 version=\u0022(1\\.0\\.0|1\\.0\\.1|1\\.0\\.2|1\\.0\\.3|1\\.1\\.0|1\\.1\\.1|1\\.1\\.2)\u0022","type":"Regex","scopes":["Code"]},{"pattern":"\u003Cpackage id=\u0022Microsoft.AspNetCore.Mvc.WebApiCompatShim\u0022 version=\u0022(1\\.0\\.0|1\\.0\\.1|1\\.0\\.2|1\\.0\\.3|1\\.1\\.0|1\\.1\\.1|1\\.1\\.2)\u0022","type":"Regex","scopes":["Code"]}],"recommendation":"Upgrade this package to a later, unaffected version.","rule_info":"4021279","severity":"Moderate","tags":["Vulerable-Dependency.Library.NuGet"]},{"applies_to":["packages.config"],"description":" Vulnerabilities in Identity Model Extensions Token Signing Verification Could Allow Elevation of Privilege","id":"DS300005","name":"Vulnerable NuGet Library","patterns":[{"pattern":"\u003Cpackage id=\u0022Microsoft.IdentityModel.Tokens\u0022 version=\u0022(5\\.1\\.0)\u0022","type":"Regex","scopes":["Code"]}],"recommendation":"Upgrade this package to a later, unaffected version.","rule_info":"3214296","severity":"Moderate","tags":["Vulerable-Dependency.Library.NuGet"]},{"applies_to":["objective-c"],"description":"Do not enable external entity resolution.","fix_its":[{"type":"RegexReplace","name":"Disable external entity resolution","pattern":{"pattern":"(shouldResolveExternalEntities\\s*=\\s*)(YES)","type":"Regex","scopes":["Code"]},"replacement":"$1NO"}],"id":"DS132779","name":"Do not enable external entity resolution.","patterns":[{"pattern":"\\b(shouldResolveExternalEntities\\s*=\\s*YES)\\b","type":"Regex","scopes":["Code"]}],"recommendation":"Set shouldResolveExternalEntities to NO.","rule_info":"DS132779.md","severity":"Moderate","tags":["Implementation.iOS.XML.DTDEntityResolution"]},{"applies_to":["swift"],"description":"Do not enable external entity resolution.","fix_its":[{"type":"RegexReplace","name":"Disable external entity resolution","pattern":{"pattern":"(shouldResolveExternalEntities\\s*=\\s*)(TRUE)","type":"Regex","scopes":["Code"]},"replacement":"$1FALSE"}],"id":"DS132780","name":"Do not enable external entity resolution.","patterns":[{"pattern":"\\b(shouldResolveExternalEntities\\s*=\\s*TRUE)\\b","type":"Regex","scopes":["Code"]}],"recommendation":"x.setShouldResolveExternalEntities = FALSE;","rule_info":"DS132780.md","severity":"Moderate","tags":["Implementation.iOS.XML.DTDEntityResolution"]},{"applies_to":["objective-c"],"description":"Do not enable external entity resolution.","fix_its":[{"type":"RegexReplace","name":"Disable external entity resolution","pattern":{"pattern":"(setShouldResolveExternalEntities:\\s*)(YES)","type":"Regex","scopes":["Code"]},"replacement":"$1NO"}],"id":"DS132790","name":"Do not enable external entity resolution.","patterns":[{"pattern":"\\b(setShouldResolveExternalEntities:\\s*YES)\\b","type":"Regex","scopes":["Code"]}],"recommendation":"[x setShouldResolveExternalEntities: NO];","rule_info":"DS132790.md","severity":"Moderate","tags":["Implementation.iOS.XML.DTDEntityResolution"]}]